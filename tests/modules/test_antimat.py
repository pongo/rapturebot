import os
import sys
import unittest
from unittest.mock import MagicMock

from src.modules.antimat.antimat import Antimat, get_default_filter, ObsceneRegexp, extended_filter_enabled

sys.modules['telegram'] = MagicMock()
sys.modules['telegram.ext'] = MagicMock()
sys.modules['src.commands'] = MagicMock()
sys.modules['src.config'] = MagicMock()
sys.modules['src.config.CONFIG'] = MagicMock()
sys.modules['src.modules.khaleesi'] = MagicMock()
sys.modules['src.utils.handlers_helpers'] = MagicMock()
sys.modules['src.utils.cache'] = MagicMock()
sys.modules['src.utils.logger'] = MagicMock()


stop_after_first_fail = True


class StopAfterFailTestCase(unittest.TestCase):
    """
    https://stackoverflow.com/a/690286/136559
    """
    def run(self, result=None):
        if stop_after_first_fail and result.failures or result.errors:
            print('aborted')
        else:
            super(StopAfterFailTestCase, self).run(result)


class ObsceneRegexpTest(StopAfterFailTestCase):
    """
    –¢–µ—Å—Ç –∏–∑ https://github.com/asyncee/python-obscene-words-filter
    """

    @classmethod
    def setUpClass(cls):
        cls.pattern_pizd = r'\b[\w]*([–øn]+(?:[^\w\s\\/])*[–µ—ëe|–∏i]+(?:[^\w\s\\/])*[–∑z]+(?:[^\w\s\\/])*[–¥d]+)[\w]*\b'
        cls.pattern_hlebalo = r'\b([—Ö][–ª][–µ][–±][–∞][–ª][–æ–∞])\b'
        cls.pattern_skipidar = r'\b([—Å][–∫][–∏][–ø][–∏][–¥][–∞][—Ä])\b'

    def test_variants_of_letter(self):
        alpha = {
            '—Ñ': '—ÑF ts',
            '–≥': '–≥g',
        }
        self.assertEqual('—ÑF|ts', ObsceneRegexp.variants_of_letter(alpha, '—Ñ'))
        self.assertEqual('–≥g', ObsceneRegexp.variants_of_letter(alpha, '–≥'))

    def test_build_bad_phrase_from_tuple(self):
        cases = {
            ('–ø', '–µ–∏', '–∑', '–¥'): self.pattern_pizd,
        }
        for k, v in cases.items():
            self.assertEqual(v, ObsceneRegexp.build_bad_phrase(*k))

    def test_build_bad_phrase_from_string(self):
        cases = {
            '–ø –µ–∏ –∑ –¥': self.pattern_pizd,
        }
        for k, v in cases.items():
            self.assertEqual(v, ObsceneRegexp.build_bad_phrase(k))

    def test_build_good_phrase_from_tuple(self):
        cases = {
            ('—Ö', '–ª', '–µ', '–±', '–∞', '–ª', '–æ–∞'): self.pattern_hlebalo,
            ('—Å', '–∫', '–∏', '–ø', '–∏', '–¥', '–∞', '—Ä'): self.pattern_skipidar,
        }
        for k, v in cases.items():
            self.assertEqual(v, ObsceneRegexp.build_good_phrase(*k))

    def test_build_good_phrase_from_string(self):
        cases = {
            '—Ö –ª –µ –± –∞ –ª –æ–∞': self.pattern_hlebalo,
            '—Å –∫ –∏ –ø –∏ –¥ –∞ —Ä': self.pattern_skipidar,
        }
        for k, v in cases.items():
            self.assertEqual(v, ObsceneRegexp.build_good_phrase(k))


class ObsceneWordsFilterTest(StopAfterFailTestCase):
    """
    –¢–µ—Å—Ç –∏–∑ https://github.com/asyncee/python-obscene-words-filter
    """

    @classmethod
    def setUpClass(cls):
        cls.words_filter = get_default_filter()

    def test_is_word_good(self):
        cases = [
            '—Ö–ª–µ–±–∞–ª–æ', '—Ö–ª–µ–±–∞–ª–∞', '—Å–∫–∏–ø–∏–¥–∞—Ä',
            '–∫–æ–ª–µ–±–∞–Ω–∏—è', '–∫–æ–ª–µ–±–∞–Ω–∏–µ', '–∫–æ–ª–µ–±–∞–Ω–∏–π',
            '–∑–∞–∫–æ–ª–µ–±–∞–ª', '–∑–∞–∫–æ–ª–µ–±–∞—Ç—å', '–∑–∞–∫–∞–ª–µ–±–∞–ª', '–∑–æ–∫–æ–ª–µ–±–∞—Ç—å',
            '—Ä—É–±–ª—è', '—Å—Ç–µ–±–µ–ª—å', '—Å—Ç—Ä–∞—Ö–æ–≤–∫–∞', '—Å—Ç—Ä–∞—Ö–æ–≤–∫—É', '—Å—Ç—Ä–∞—Ö–æ–≤–∫–∏',
            '–æ—Å–∫–æ—Ä–±–ª—è—Ç—å', '–æ—Å–∫–æ—Ä–±–ª—è–µ—à—å', '–æ—Å–∫–æ—Ä–±–ª—è–ª',
            '–≤–ª—é–±–ª—è—Ç—å', '–≤–ª—é–±–ª—è–µ—à—å—Å—è',
            '–ø–æ–¥—Å—Ç—Ä–∞—Ö—É–π', '–∑–∞—Å—Ç—Ä–∞—Ö—É–π', '–ø–æ–¥—Å—Ç—Ä–∞—Ö—É–µ—Ç', '–∑–∞—Å—Ç—Ä–∞—Ö—É–µ—Ç', '–∑–∞—Å—Ç—Ä–∞—Ö—É–µ—à—å—Å—è',
            '–º–µ–±–µ–ª—å–Ω—ã–π',
            '—É–ø–æ—Ç—Ä–µ–±–ª—è—Ç—å', '—É–ø–æ—Ç—Ä–µ–±–ª—è–µ—à—å', '—É–ø–æ—Ç—Ä–µ–±–ª—è–ª',
            '–∏—Å—Ç—Ä–µ–±–ª—è—Ç—å', '–∏—Å—Ç—Ä–µ–±–ª—è–µ—à—å', '–∏—Å—Ç—Ä–µ–±–ª—è–ª',
            '—Å—Ç—Ä–∞—Ö', '—Å—Ç—Ä–∞—Ö–∞',
        ]
        for word in cases:
            self.assertTrue(self.words_filter.is_word_good(word), word)

    def test_is_word_bad(self):
        good = {
            '—Ö–ª–µ–±–∞–ª–æ', '—Ö–ª–µ–±–∞–ª–∞', '—Å–∫–∏–ø–∏–¥–∞—Ä',
        }
        extended = {'–ø–∏–¥–æ—Ä', '–ø–∏–¥–∞—Ä', '–ø–∏–¥–µ—Ä', '–ø–∏–¥—Ä', '–≥–æ–≤–Ω–æ', '–≥–∞–≤–Ω–æ', '–º—É–¥–∞–∫', '–º—É–¥–∞—á—å—ë', '–≥–æ–Ω–¥–æ–Ω',
                    '—á–º–æ', '–¥–µ—Ä—å–º–æ', '—à–ª—é—Ö–∞', '–∑–∞–ª—É–ø–∞', '–∑–æ–ª—É–ø–∞', '–º–∞–Ω–¥–∞', '–º–æ–Ω–¥–∞', '—Å—É—á–∞—Ä–∞'}
        bad = [
            '–ø–∏–∑–¥–∞', '–ø–∏–∑–¥–µ—Ü', '–ø–∏–∑–¥—ã', '–ø–µ–∑–¥–∞',
            '—Ö—É–π', '—Ö—É–π–ª–æ', '—Ö—É—é—à–∫–∏',
            '–æ—Ö—É–µ–≤—à–∏–π', '–æ—Ö—É–µ–ª', '–æ—Ö—É–µ—Ç—å',
            '–ø–∏–¥–æ—Ä', '–ø–∏–¥–∞—Ä', '–ø–∏–¥–µ—Ä', '–ø–∏–¥—Ä',
            '–µ–±–∞–Ω—ã–π', '–µ–±–∞–∫–∞', '–µ–±–∞–ª–æ', '—ë–±–∞–Ω—ã–π', '–µ–±–∞—Ç—å',
            '—É–µ–±–∞–Ω', '—É—ë–±–æ–∫', '—É–µ–±–æ—Ç',
            '–µ–±–ª–æ', '—ë–±–ª–∞', '—ë–±–ª–∏', '–µ–±–ª–∏',
            '–≤—ã–µ–±', '–≤—ã—ë–±', '–≤—ã–µ–±–ª–∏', '–≤—ã–µ–±–∞–ª–∏',
            '–±–ª—è', '–≥–æ–≤–Ω–æ', '–≥–∞–≤–Ω–æ', '–º—É–¥–∞–∫', '–º—É–¥–∞—á—å—ë',
            '–≥–æ–Ω–¥–æ–Ω', '—á–º–æ', '–¥–µ—Ä—å–º–æ', '—à–ª—é—Ö–∞', '–∑–∞–ª—É–ø–∞', '–∑–æ–ª—É–ø–∞',
            '–º–∞–Ω–¥–∞', '–º–æ–Ω–¥–∞', '—Å—É—á–∞—Ä–∞', '–¥–∞–ª–±–∞—ë–±', '–¥–æ–ª–±–æ—ë–±', '–¥–∞–ª–±–∞—ë–±—ã',
        ]
        if not extended_filter_enabled:
            bad = list(set(bad) - extended)
            good.update(extended)
            for word in extended:
                self.assertEqual(0, Antimat.bad_words_count(word), word)
        for word in bad:
            self.assertTrue(self.words_filter.is_word_bad(word), word)
        for word in good:
            self.assertFalse(self.words_filter.is_word_bad(word), word)

    def test_is_word_bad_case_insensitive(self):
        bad = ['–ø–∏–∑–¥–∞', '–ü–ò–ó–î–ê']
        for word in bad:
            self.assertTrue(self.words_filter.is_word_bad(word), word)

    def test_is_word_good_case_insensitive(self):
        cases = {
            '—Å–∫–∏–ø–∏–¥–∞—Ä': True,
            '–°–ö–ò–ü–ò–î–ê–†': True,
        }
        for k, v in cases.items():
            self.assertEqual(v, self.words_filter.is_word_good(k))

    def test_find_bad_word_matches(self):
        cases = {
            ' –ø–∏–∑–¥–µ—Ü –ø–∏–∑–¥–∞ –æ–ø–∏–∑–¥–µ—Ç—å –≤–æ—Ç —ç—Ç–æ –¥–∞': ['–ø–∏–∑–¥–µ—Ü', '–ø–∏–∑–¥–∞', '–æ–ø–∏–∑–¥–µ—Ç—å'],
            '—Ö—É–π–ª–æ —Ö—É–π —Ö—É—ë–≤—ã–π —Ö—É—è—Å–µ –ø–∏—Ä–æ–∂–æ–∫': ['—Ö—É–π–ª–æ', '—Ö—É–π', '—Ö—É—ë–≤—ã–π', '—Ö—É—è—Å–µ'],

            '—Å–æ–±–∞–∫–∞ –µ–±–∞–Ω—ã–π –∏ —ë–±–∞–Ω—ã–π –µ–±–∞–ª–æ –µ–±–∞–∫–∞ –µ–±–∞—Ç—É–π': ['–µ–±–∞–Ω—ã–π', '—ë–±–∞–Ω—ã–π', '–µ–±–∞–ª–æ', '–µ–±–∞–∫–∞', '–µ–±–∞—Ç—É–π'],
            '—É–µ–±–∞–ª—Å—è —É–µ–±–∞—Ç—å —É–µ–±–∞–∫ —É–µ–±–æ–∫ —É—ë–±–æ–∫': ['—É–µ–±–∞–ª—Å—è', '—É–µ–±–∞—Ç—å', '—É–µ–±–∞–∫', '—É–µ–±–æ–∫', '—É—ë–±–æ–∫'],
            '–æ—Ö—É–µ–≤—à–∏–π –æ—Ö—É–µ—Ç—å –æ—Ö—É–µ–ª –û–•–£–ï–¢–¨ –û—Ö—É–µ–ª –æ—Ö—É–µ–≤–∞—é': ['–æ—Ö—É–µ–≤—à–∏–π', '–æ—Ö—É–µ—Ç—å', '–æ—Ö—É–µ–ª', '–û–•–£–ï–¢–¨', '–û—Ö—É–µ–ª', '–æ—Ö—É–µ–≤–∞—é'],
        }
        if extended_filter_enabled:
            cases.update({
                '—Ç—Ä–∞–º–≤–∞–π –ø–∏–¥–∞—Ä –ø–∏–¥–∞—Ä–∞–∑ –ø–∏–¥–æ—Ä –ø–∏–¥–µ—Ä –ø–∏–¥–µ—Ä–∞—Å—Ç –ª–æ–∫–æ–º–æ—Ç–∏–≤': ['–ø–∏–¥–∞—Ä', '–ø–∏–¥–∞—Ä–∞–∑', '–ø–∏–¥–æ—Ä', '–ø–∏–¥–µ—Ä', '–ø–∏–¥–µ—Ä–∞—Å—Ç'],
            })

        for k, v in cases.items():
            self.assertSequenceEqual(
                set(v),
                set([m.group() for m in self.words_filter.find_bad_word_matches(k)]))

    def test_find_bad_word_matches_without_good_words(self):
        cases = {
            '–µ–±–∞–ª–æ —Ö–ª–µ–±–∞–ª–æ': ['–µ–±–∞–ª–æ'],
        }
        if extended_filter_enabled:
            cases.update({'–ø–∏–¥–∞—Ä —Å–∫–∏–ø–∏–¥–∞—Ä –ø–∏–¥–æ—Ä': ['–ø–∏–¥–∞—Ä', '–ø–∏–¥–æ—Ä']})
        for k, v in cases.items():
            self.assertSequenceEqual(
                set(v),
                set([m.group() for m in self.words_filter.find_bad_word_matches_without_good_words(k)]))

    @unittest.skip
    def test_mask_text_range(self):
        self.assertEqual('012**56789', self.words_filter.mask_text_range('0123456789', 3, 5))
        self.assertEqual('-----06789', self.words_filter.mask_text_range('0123456789', 1, 6, symbol='-'))

    @unittest.skip
    def test_mask_bad_words(self):
        cases = {
            '–û—Ö—É–µ—Ç—å, —Ç–æ–≤–∞—Ä–∏—â–∏! –≠—Ç–æ –ø–∏–∑–¥–µ—Ü! –•—É–π! –í—á–µ—Ä–∞ –µ—Ö–∞–ª –Ω–∞ –≥–∞–∑–µ–ª–∏ ‚Äî —É–µ–±–∞–ª—Å—è –≤ –∫–∞–º–∞–∑! –•—É–π.': (
                '******, —Ç–æ–≤–∞—Ä–∏—â–∏! –≠—Ç–æ ******! ***! –í—á–µ—Ä–∞ –µ—Ö–∞–ª –Ω–∞ –≥–∞–∑–µ–ª–∏ ‚Äî ******* –≤ –∫–∞–º–∞–∑! ***.'
            ),
            '–î–∞ –æ—Ö—É–µ—Ç—å –±–ª—è—Ç—å, –≤—ã —á—Ç–æ, —Å—É–∫–∏, –∑–∞–µ–±–∞–ª–∏, –æ—Ö—É–µ–ª–∏ —Å–æ–≤—Å–µ–º –≤ –∫–æ–Ω–µ—Ü —É–∂–µ!': (
                '–î–∞ ****** *****, –≤—ã —á—Ç–æ, —Å—É–∫–∏, *******, ****** —Å–æ–≤—Å–µ–º –≤ –∫–æ–Ω–µ—Ü —É–∂–µ!'
            ),
            u'–î–æ–ª–±–æ—ë–±–∞–º –∏ –ª—é–±–æ–π —Ç—É–ø–æ–π –ø–∏–∑–¥–µ –≤—Ö–æ–¥ –∑–∞–∫—Ä—ã—Ç, –Ω–∞—Ö—É–π –∏ –Ω–µ –µ–±—ë—Ç.': (
                u'********* –∏ –ª—é–±–æ–π —Ç—É–ø–æ–π ***** –≤—Ö–æ–¥ –∑–∞–∫—Ä—ã—Ç, ***** –∏ –Ω–µ ****.'
            ),
        }

        for k, v in cases.items():
            self.assertEqual(v, self.words_filter.mask_bad_words(k))


class PhpCensureTest(StopAfterFailTestCase):
    """
    –ö–æ–µ-—á—Ç–æ –∏–∑ https://github.com/rin-nas/php-censure
    """

    def test_pretext(self):
        words = ['—É–µ–±–∞—Ç—å', '–æ—Ö—É–µ—Ç—å', '–∞—Ö—É–µ—Ç—å', '–≤—Å–ø–∏–∑–¥–Ω—É—Ç—å', '–∫–æ–Ω–æ–µ–±–∏—Ç—å—Å—è', '–º—É–¥–∞—ë–±',
                 '–æ—Å—Ç–æ–ø–∏–∑–¥–µ–ª–æ', '—Ö—É–¥–æ–µ–±–∏–Ω–∞', '–≤–ø–∏–∑–¥—è—á–∏—Ç—å', '—Å—Ö—É—è—Ä–∏—Ç—å', '—Å—ä–µ–±–∞—Ç—å—Å—è', '–≤—ä–µ–±–∞—Ç—å', '—ë–±–ª—è']
        for word in words:
            self.assertEqual(1, Antimat.bad_words_count(word), word)

    def test_bad_words_x(self):
        words = ['—Ö—É–π', '—Ö—É—è', '—Ö—É—é', '—Ö—É–µ–º', '—Ö—É—ë–≤—ã–π', '–æ—Ö—É–∏—Ç–µ–ª—å–Ω—ã–π']
        for word in words:
            self.assertEqual(1, Antimat.bad_words_count(word), word)

    def test_bad_words_p(self):
        words = {'–ø–∏–∑–¥–∞', '–ø–µ–∑–¥–∞', '–ø–µ–∑–¥—ã', '–ø–∏–∑–¥–µ', '–ø–∏–∑–¥—ë–∂', '–ø–∏–∑–¥—É', '–ø–∏–∑–¥—é–ª–∏–Ω–∞', '–ø–∏–∑–¥–æ–±–æ–ª',
                 '–æ–ø–∏–∑–¥–∏–Ω–µ—Ç—å', '–ø–∏–∑–¥—ã—Ö', '–ø–æ–¥–ø—ë–∑–¥—ã–≤–∞—Ç—å'}
        extended = {'–ø–∏–¥–æ—Ä', '–ø–µ–¥–æ—Ä', '–ø–∏–¥–∞—Ä'}
        if extended_filter_enabled:
            words.update(extended)
        else:
            for word in extended:
                self.assertEqual(0, Antimat.bad_words_count(word), word)
        for word in words:
            self.assertEqual(1, Antimat.bad_words_count(word), word)

    def test_bad_words_e(self):
        words = ['–µ–±—É', '–µ–±–∏', '–µ–±—É—Ç', '–µ–±–∞—Ç—å', '–µ–±–∏—Å—å', '–µ–±—ë—Ç', '–ø–æ–µ–±–æ—Ç–∏–Ω–∞', '–≤—ã–µ–±—ã–≤–∞—Ç—å—Å—è', '—ë–±–∞—Ä—å', '–µ–±–ª–æ',
                 '–µ–±–ª–∞', '–µ–±–ª–∏–≤–∞—è', '–µ–±–ª–∏—Å—å', '–µ–±–ª—ã—Å—å', '—ë–±–ª—è', '—ë–±–Ω—É–ª', '—ë–±–Ω—É—Ç—ã–π', '–≤–∑—ä—ë–±–∫–∞', '–µ–±—Å—Ç–∏',
                 '–¥–æ–ª–±–æ—ë–±', '–¥—É—Ä–∞—ë–±', '–∏–∑—ä—ë–±', '–∑–∞—ë–±', '–∑–∞–µ–±–∞–π', '—Ä–∞–∑—ä–µ–±–∞–π', '–º—É–¥–æ—ë–±—ã', '—ë–±']
        for word in words:
            self.assertEqual(1, Antimat.bad_words_count(word), word)

    def test_bad_words_b(self):
        words = ['–±–ª—è', '–±–ª—è—Ç—å', '–±–ª—è–¥–∏']
        for word in words:
            self.assertEqual(1, Antimat.bad_words_count(word), word)

    def test_bad_words_m(self):
        words = set()
        extended = {'–º—É–¥–∞–∫', '–º—É–¥–∞—á–æ–∫'}
        if extended_filter_enabled:
            words.update(extended)
        else:
            for word in extended:
                self.assertEqual(0, Antimat.bad_words_count(word), word)
        for word in words:
            self.assertEqual(1, Antimat.bad_words_count(word), word)

    def test_manda(self):
        bad = '–º–∞–Ω–¥–∞'.split(' ')
        good = '–≥–æ—Ä–æ–¥ –ú–∞–Ω–¥–∞–ª–∞–π, –æ–∫—Ä—É–≥ –ú–∞–Ω–¥–∞–ª—å, –∏–Ω–¥–µ–π—Å–∫–∏–π –Ω–∞—Ä–æ–¥ –ú–∞–Ω–¥–∞–Ω, —Ñ–∞–º–∏–ª–∏—è –ú–∞–Ω–¥–µ–ª—å, –º–∞–Ω–¥–∞—Ä–∏–Ω, –º–∞–Ω–¥–∞—Ä–∏–Ω–∫–∞'.split(', ')
        is_good = 0 if extended_filter_enabled else 0
        is_bad = 1 if extended_filter_enabled else 0
        for word in good:
            self.assertEqual(is_good, Antimat.bad_words_count(word), word)
        for word in bad:
            self.assertEqual(is_bad, Antimat.bad_words_count(word), word)


class FilesTest(StopAfterFailTestCase):
    messages_collection = r'..\tmp\antimat\messages_collection.txt'
    # —Å–ª–æ–≤–∞—Ä–∏ —Ä—É—Å—Å–∫–∏—Ö —Å–ª–æ–≤
    # https://github.com/danakt/russian-words
    # http://speakrus.ru/dict/index.htm
    # http://blog.harrix.org/article/3334
    words = r'..\tmp\antimat\words\words.txt'

    @unittest.skipUnless(os.path.exists(messages_collection), 'file not found')
    @unittest.skip
    def test_split_words(self):
        import re
        words = set()
        with open(self.messages_collection, 'r', encoding='utf-8') as f:
            for line in f:
                words.update(word for word in re.split(r'[,.\s;:()!@#$%^&*"\'‚Ññ?<>/|\\=+~`¬´¬ª‚Äû‚Äú‚Äù‚Äî]+', line.lower()))
        with open(r'..\tmp\messages_collection_words.txt', 'w', encoding='utf-8') as f:
            f.writelines(f'{word}\n' for word in sorted(words))

    @unittest.skipUnless(os.path.exists(messages_collection), 'file not found')
    @unittest.skip
    def test_messages_collection(self):
        bad_words = set()
        with open(self.messages_collection, 'r', encoding='utf-8') as f:
            for line in f:
                bad_words.update(word.lower() for word in Antimat.bad_words(line))
        with open(r'..\tmp\antimat\messages_collection_bad.txt', 'w', encoding='utf-8') as f:
            f.writelines(f'{word}\n' for word in sorted(bad_words))

    @unittest.skipUnless(os.path.exists(words), 'file not found')
    @unittest.skip
    def test_words(self):
        bad_words = set()
        with open(self.words, 'r', encoding='utf-8') as f:
            for line in f:
                # self.assertEqual(0, Antimat.bad_words_count(line), line)
                bad_words.update(word.lower() for word in Antimat.bad_words(line))
        with open(r'..\tmp\antimat\words\words_bad.txt', 'w', encoding='utf-8') as f:
            f.writelines(f'{word}\n' for word in sorted(bad_words))

    # noinspection PyNestedDecorators
    @unittest.skip
    @staticmethod
    def test_wp():
        bad_words = set()
        with open(r'..\tmp\antimat\text_for_mat.txt', 'r', encoding='utf-8') as f:
            for line in f:
                bad_words.update(word.lower() for word in Antimat.bad_words(line))
        with open(r'..\tmp\antimat\text_for_mat_bad.txt', 'w', encoding='utf-8') as f:
            f.writelines(f'{word}\n' for word in sorted(bad_words))


class AntimatTest(StopAfterFailTestCase):
    def test_empty(self):
        self.assertEqual(0, Antimat.bad_words_count(''))

    def test_count(self):
        self.assertEqual(4, Antimat.bad_words_count('–î–∞ –æ—Ö—É–µ—Ç—å –±–ª—è—Ç—å, –≤—ã –∑–∞–µ–±–∞–ª–∏, –æ—Ö—É–µ–ª–∏ —Å–æ–≤—Å–µ–º –≤ –∫–æ–Ω–µ—Ü —É–∂–µ!'))

    def test_names(self):
        words = '–û—Ä–∑—ç–º—ç—Å, –í–∞—Ä–∑–∞–º–µ—Å, –£—ç–∑—ã—Ä–º—ç—Å, –û—Ä–∑–∏–∫, –ê—Ä–∑–∞–º–∞—Å, –û—Ä–≥–∞–Ω–∞–π–∑–µ—Ä, –û—Ä–µ–Ω–±—É—Ä–≥, –û—Ä–Ω–∞–º–µ–Ω—Ç, –ê—Ä–∏–∑–æ–Ω–∞, –û–∑–∞—Ä–∫, –ê—Ä—å–µ–≥–∞—Ä–¥, –û—Å–∏—Ä–∏—Å, –û–∑–∏–º–∞–Ω–¥–∏–π, Orgazmotron, –ê—Ä–∫–∞–º–±–∞–∑, –ê—Ä–∫–∞–Ω–∑–∞—Å, –û—Ä–∑—É–º–∞–Ω–¥–∏–π, –Æ—Ä–∏–π, –ê–Ω—É–±–∏—Å, –û–∑–∞—Ä–∏–π, –û—Ä–∞–Ω–≥–∑–µ–±, –û—Ä–∑–∞–±—ç–ª—å, –û—Ä–º–µ—Ç–µ—Å, –û—Ä–∞–∑–≥—É–ª—å, –û—Ä–∑–æ–º–µ—Ç—Ä, –û—Ä–∏–æ–Ω, –û—Ä–∞–∫—É–ª, –û—Ä–µ–≥–æ–Ω, –û—Ä–∫–µ—Å—Ç—Ä, –û—Ä–Ω–∏—Ç–æ–ª–æ–≥, –û—Ä—Ç–æ–ø–µ–¥, –û—Ä–µ–Ω–±—É—Ä–≥, –û—Ä–Ω–∏—Ç–æ–ø–æ–¥, –û—Ä–Ω–∞–º–µ–Ω—Ç, –û—Ä—Ç–∞–Ω–æ–≥–µ–Ω–µ–∑, –û—Ä—Ç–æ–¥–æ–∫—Å, –û–±—Å–∫—É—Ä, –û—Ä–±–∞–∫–∞–π—Ç–µ, –û—Ä–≥–∞–∑–º–æ–ª–æ–≥, –û—Ä–¥–∞–±–∞—Å—ã, –û—Ä–≥–∞–∑–º–∞–π–∑–µ—Ä, –û—Ä—Å–∏–º–µ—Ä, –ø–æ–∫—É–ø–∞–µ—à—å –ø–µ—á–µ–Ω—å–µ –û–†–ï–û, –û—Ç–æ—Ä–∏–Ω–æ–ª–∞—Ä–∏–Ω–≥–æ–ª–æ–≥, –û–º–∞–≥–∞—Ç, –û—Ä–∑–∞–Ω –ö–∞–¥—ã—Ä–æ–≤, –ê—Ä—Ç–º–∞–Ω–∏, –í–∏–∫—Ç–æ—Ä –¶–æ–π, –∑–∞–∫–∞–∑—ã–≤–∞–µ—à—å —Å—É—à–∏, –Ω–æ—Å–∏—à—å –±–æ—Ä–æ–¥—É, –≤—É–∞–ø—â–µ –∫—Ä–∞—Å–∞—É—á–∏–∫ üòò, –∏–≥—Ä–∞–µ—à—å –¥–∂–∞–∑, –¥–∞—Ä–∏—à—å –¥–µ–≤—É—à–∫–∞–º —Ü–≤–µ—Ç—ã, –ù–ï –ø–æ—Å—Ç–∏—à—å —Å–µ–ª—Ñ–∏, –ë–æ—Ä—â –° –í–æ–¥–æ—á–∫–æ–π, —Ç–∞–∫ –≥—Ä–∞—Ü–∏–æ–∑–Ω–∞ –∏ –º–∏–ª–∞. –æ–±–≤–æ—Ä–æ–∂–∏—Ç–µ–ª—å–Ω–∞. –ø—Ä–µ–∫—Ä–∞—Å–Ω–∞. —Ç—ã —Ç–∞–∫ –∂–µ–ª–∞–Ω–Ω–∞ –∏ –æ–ø–∞—Å–Ω–∞. —Ç–µ–±–µ –≤–µ–¥—å –Ω–µ—Ç –µ—â–µ 16 –ª–µ—Ç, –û—Ä–∏—Ñ–ª–µ–π–º—Å, –ø–æ–∫—É–ø–∞–µ—à—å –∞–≤—Ç–æ–º–∞—Ç, –≥–æ–≤–æ—Ä–∏—à—å –≤—Å–µ–º –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç—ã, –ø—å–µ—à—å –ø—Ä—è–º–æ —Å —É—Ç—Ä–∞, –û–∑–∏–¥—è–∏–º–∞, –ú–µ—Ä–∑–æ–º–µ—Å, –û—Ä–∑–∞–º–µ–Ω—Ç, –û—Ä–∑–∞–º–µ–º—Å, –ë–æ–¥–∏—Ñ–ª–µ–∫—Å, –û–∫—Å–∏—Å–∞–π–∑, –û–∑–∞—Ä–∫, –ì–Ω–æ–º–µ—Ä–∑–∞—Å, –û–π–∑—ç–º—ç—Å, –û—Ä–µ–∑–µ–º–µ—Å, –ê–¥–∏–Ω–æ—Å–ª–∞–≤, –ê–¥–∏—Å–ª–∞–≤, –ê–¥—ã—Å–ª–∞–≤, –ê–Ω–∞—Å—Ç–∞—Å–ª–∞–≤, –ê–Ω–∏—Å–ª–∞–≤, –ë–µ–¥–∏—Å–ª–∞–≤, –ë–µ–ª–æ—Å–ª–∞–≤, –ë–µ–Ω–∏—Å–ª–∞–≤, –ë–µ—Ä–µ—Å–ª–∞–≤, –ë–µ—Ä–∏—Å–ª–∞–≤, –ë–µ—á–∏—Å–ª–∞–≤, –ë–ª–∞–≥–æ—Å–ª–∞–≤, –ë–æ–≥–æ—Å–ª–∞–≤, –ë–æ–≥—É—Å–ª–∞–≤, –ë–æ–¥–µ—Å–ª–∞–≤, –ë–æ–µ—Å–ª–∞–≤, –ë–æ–∂–µ—Å–ª–∞–≤, –ë–æ–ª–µ—Å–ª–∞–≤, –ë–æ—Ä–∏—Å–ª–∞–≤, –ë–æ—Ö–∞—Å–ª–∞–≤, –ë—Ä–∞–Ω–∏—Å–ª–∞–≤, –ë—Ä–∞—Ç–∏—Å–ª–∞–≤, –ë—Ä–∞—Ü–∏—Å–ª–∞–≤, –ë—Ä–æ–Ω–µ—Å–ª–∞–≤, –ë—Ä–æ–Ω–∏—Å–ª–∞–≤, –ë—Ä—è—á–∏—Å–ª–∞–≤, –ë—É–¥–∏—Å–ª–∞–≤, –ë—É–µ—Å–ª–∞–≤, –ë—É—Å–ª–∞–≤, –ë—ã—Å–ª–∞–≤, –í–∞–¥–∏—Å–ª–∞–≤, –í–∞–∫—Å–ª–∞–≤, –í–∞—Ä—Ç–∏—Å–ª–∞–≤, –í–∞—Å–ª–∞–≤, –í–∞—Å–ª–∞–≤–∏–π, –í–∞—Ç—Ä–æ—Å–ª–∞–≤, –í–∞—Ü–ª–∞–≤, –í–µ–∫–æ—Å–ª–∞–≤, –í–µ–ª–µ—Å–ª–∞–≤, –í–µ–Ω–µ—Å–ª–∞–≤, –í–µ–Ω–∫–µ—Å–ª–∞–≤, –í–µ–Ω–∏—Å–ª–∞–≤, –í–µ–Ω—Ü–µ—Å–ª–∞–≤, –í–µ—Ä–∏—Å–ª–∞–≤, –í–µ—Ä–æ—Å–ª–∞–≤, –í–µ—Ä—Ö–æ—Å–ª–∞–≤, –í–µ—Å–ª–∞–≤, –í–µ—Å—Ç–∏—Å–ª–∞–≤, –í–∏–¥–∏—Å–ª–∞–≤, –í–∏–¥–æ—Å–ª–∞–≤, –í–∏–ª–µ–Ω—Å–ª–∞–≤, –í–∏–ª–∏—Å–ª–∞–≤, –í–∏—Ä–æ—Å–ª–∞–≤, –í–∏—Å–ª–∞–≤, –í–∏—Ç–∞—Å–ª–∞–≤, –í–∏—Ç—á–µ—Å–ª–∞–≤, –í–∏—Ç—è–∑–æ—Å–ª–∞–≤, –í–∏—à–µ—Å–ª–∞–≤, –í–ª–∞–¥–∂–∏—Å–ª–∞–≤, –í–ª–∞–¥–∏—Å–ª–∞–≤, –í–ª–∞—Å—Ç–∏—Å–ª–∞–≤, –í–Ω–∏—Å–ª–∞–≤, –í–æ–∏—Å–ª–∞–≤,–í–æ–ª–µ—Å–ª–∞–≤, –í–æ—Ä–æ—Ç–∏—Å–ª–∞–≤, –í—Ä–∞—Ç–∏—Å–ª–∞–≤, –í—Ä–æ—Å—Ç–∏—Å–ª–∞–≤, –í—Å–µ—Å–ª–∞–≤, –í—É–∫–æ—Å–ª–∞–≤, –í—á–µ—Å–ª–∞–≤, –í—ã—à–µ—Å–ª–∞–≤, –í—è—Ç—á–µ—Å–ª–∞–≤, –ì–æ–¥–∏—Å–ª–∞–≤, –ì–æ–¥–æ—Å–ª–∞–≤, –ì–æ—Ä–µ—Å–ª–∞–≤, –ì–æ—Ä–∏—Å–ª–∞–≤, –ì–æ—Å—Ç–∏—Å–ª–∞–≤, –ì—Ä–∞–¥–∏—Å–ª–∞–≤, –ì—Ä–∞–Ω–∏—Å–ª–∞–≤, –ì—Ä–µ–º–∏—Å–ª–∞–≤, –ì—É–±–∏—Å–ª–∞–≤, –ì—É–¥–∏—Å–ª–∞–≤, –î–∞–ª–µ—Å–ª–∞–≤, –î–∞–Ω–∏—Å–ª–∞–≤, –î–∞–Ω—Å–ª–∞–≤, –î–∞–Ω—å—Å–ª–∞–≤, –î–∞—Ä–æ—Å–ª–∞–≤, –î–µ–¥–æ—Å–ª–∞–≤, –î–µ–∑–∏—Å–ª–∞–≤, –î–µ–Ω–∏—Å–ª–∞–≤, –î–µ—Å–∏—Å–ª–∞–≤, –î–æ–±—Ä–æ—Å–ª–∞–≤, –î–æ–º–æ—Å–ª–∞–≤, –î–æ–º–∏—Å–ª–∞–≤, –î–æ—Ä–∏—Å–ª–∞–≤, –î—Ä–∞–≥–æ—Å–ª–∞–≤, –ï–≥–æ—Å–ª–∞–≤, –ï–≥–æ—Å–ª–∞–≤–∏–π, –ï–∑–¥–∏—Å–ª–∞–≤, –ï—Ä–æ—Å–ª–∞–≤, –ï—Å–∏—Å–ª–∞–≤, –ó–∞—Ä–µ—Å–ª–∞–≤, –ó–∞—Ä–∏—Å–ª–∞–≤, –ó–∞—Å–ª–∞–≤, –ó–±—ã—Å–ª–∞–≤, –ó–≤–µ–Ω–∏—Å–ª–∞–≤, –ó–≤–æ–Ω–∏—Å–ª–∞–≤, –ó–¥–µ—Å–ª–∞–≤, –ó–¥–∏—Å–ª–∞–≤, –ó–ª–∞—Ç–∏—Å–ª–∞–≤, –ó–ª–∞—Ç–æ—Å–ª–∞–≤, –ó–æ—Ä–µ—Å–ª–∞–≤, –ò–∑—è—Å–ª–∞–≤, –ò—Å—Ç–∏—Å–ª–∞–≤, –ö–∞–ª–∏—Å–ª–∞–≤, –ö–∞—Ä–µ—Å–ª–∞–≤, –ö–∞—Ä–∏—Å–ª–∞–≤, –ö—Ä–∞–π—Å–ª–∞–≤, –ö—Ä–∞—Å–Ω–æ—Å–ª–∞–≤, –ö—Ä–∏—Ç–∏—Å–ª–∞–≤, –õ–∞–¥–∏—Å–ª–∞–≤, –õ–µ–Ω–∏—Å–ª–∞–≤, –õ–µ–Ω—Å–ª–∞–≤, –õ–µ—Ç–æ—Å–ª–∞–≤, –õ–∏—Ç–æ—Å–ª–∞–≤, –õ–∏—Ö–æ—Å–ª–∞–≤, –õ—É–¥–∏—Å–ª–∞–≤, –õ–µ—Å–ª–∞–≤, –õ–µ—Ö–æ—Å–ª–∞–≤, –õ—é–±–æ—Å–ª–∞–≤, –ú–∞–π–µ—Å–ª–∞–≤, –ú–µ—á–µ—Å–ª–∞–≤, –ú–∏–ª–æ—Å–ª–∞–≤, –ú–∏—Ä–æ—Å–ª–∞–≤, –ú—Å—Ç–∏—Å–ª–∞–≤, –ú—Å—Ü–∏—Å–ª–∞–≤, –ù–µ–≥–æ—Å–ª–∞–≤, –û–≥–Ω–µ—Å–ª–∞–≤, –û–¥–µ—Å–ª–∞–≤, –û–¥–∏—Å–ª–∞–≤, –ü–µ—Ä–µ—Å–ª–∞–≤, –ü–µ—Ä–µ—è—Å–ª–∞–≤, –ü—Ä–∞–≤–æ—Å–ª–∞–≤, –ü—Ä–µ—Å–ª–∞–≤, –ü—É—Ç–∏—Å–ª–∞–≤, –ü—à–µ–º—ã—Å–ª–∞–≤, –†–∞–¥–∞—Å–ª–∞–≤, –†–∞–¥–∏—Å–ª–∞–≤, –†–∞–¥–æ—Å–ª–∞–≤, –†–∞—Ç–∏—Å–ª–∞–≤, –†–∞—Å—Ç–∏—Å–ª–∞–≤, –†–∞—Å–ª–∞–≤, –†–æ—Å–ª–∞–≤, –†–æ—Å—Ç–∏—Å–ª–∞–≤, –†–æ—Å—Ü–∏—Å–ª–∞–≤, –†–æ—Å—Ü–∏—Å–ª–∞—É, –†—É–¥–æ—Å–ª–∞–≤, –†—É—Å–ª–∞–≤–∏–π, –°–±—ã—Å–ª–∞–≤, –°–≤–µ—Ç–∏—Å–ª–∞–≤, –°–≤–µ—Ç–æ—Å–ª–∞–≤, –°–≤–æ–π—Å–ª–∞–≤, –°–≤—è—Ç–æ—Å–ª–∞–≤, –°–¥–µ—Å–ª–∞–≤, –°–ª–∞–≤–∞, –°–ª–∞–≤–∏–∫, –°–ª–∞–≤–æ–∑–∞—Ä, –°–ª–∞–≤–æ–∑–∞–≤—Ä, –°–ª–∞–≤–æ–º–∏—Ä, –°–æ–±–µ—Å–ª–∞–≤, –°–æ–±–∏—Å–ª–∞–≤, –°—Ç–∞–ª–∏–Ω–æ—Å–ª–∞–≤, –°—Ç–∞–Ω–∏—Å–ª–∞–≤, –°—Ç–∞–Ω–∏—Å–ª–∞—Å, –°—Ç–∞—Ä–∏—Å–ª–∞–≤, –°—Ç—Ä–µ–∑–∏—Å–ª–∞–≤, –°—É–¥–∏—Å–ª–∞–≤, –°—É–ª–∏—Å–ª–∞–≤, –¢–∞–∏—Å–ª–∞–≤, –¢–≤–µ—Ä–¥–∏—Å–ª–∞–≤, –¢–≤–µ—Ä–¥–æ—Å–ª–∞–≤, –¢–≤–æ—Ä–∏—Å–ª–∞–≤, –¢–µ—Ä–ø–∏—Å–ª–∞–≤, –¢–µ—Ö–æ—Å–ª–∞–≤, –¢–∏—Ö–æ—Å–ª–∞–≤, –¢–æ–ª–∏—Å–ª–∞–≤, –¢–æ–º–∏–ª–æ—Å–ª–∞–≤, –¢–æ–º–∏—Å–ª–∞–≤, –¢—Ä–µ–±–∏—Å–ª–∞–≤, –¢—Ä—É–¥–æ—Å–ª–∞–≤, –£—Å–ª–∞–≤, –•–≤–∞–ª–∏—Å–ª–∞–≤, –•–ª–µ–±–æ—Å–ª–∞–≤, –•–æ–¥–∏—Å–ª–∞–≤, –•–æ—Ç–∏—Å–ª–∞–≤, –•—Ä–∞–Ω–∏—Å–ª–∞–≤, –•—Ä–∏—Å—Ç–æ—Å–ª–∞–≤, –¶–≤–µ—Ç–∏—Å–ª–∞–≤, –¶–≤–µ—Ç–æ—Å–ª–∞–≤, –¶–¥–∏—Å–ª–∞–≤, –¶–µ—Å–ª–∞–≤–∏–π, –¶—Ç–∏—Å–ª–∞–≤, –ß–∞–µ—Å–ª–∞–≤, –ß–∞—Å–ª–∞–≤, –ß–µ—Å–ª–∞–≤, –ß–µ—Å—Ç–∏—Å–ª–∞–≤, –ß–∏—Å–ª–∞–≤, –ß–∏—Å—Ç–æ—Å–ª–∞–≤, –ß—Ç–∏—Å–ª–∞–≤, –ß—É—Ä–æ—Å–ª–∞–≤, –≠—Ä–∏—Å–ª–∞–≤, –Æ–≥–æ—Å–ª–∞–≤–∏–π, –Æ—Ä–∞—Å–ª–∞–≤, –Æ—Ä–µ—Å–ª–∞–≤, –Æ—Ä–∏—Å–ª–∞–≤, –Æ—Ä–æ—Å–ª–∞–≤, –Ø–Ω–∏—Å–ª–∞–≤, –Ø—Ä–æ—Å–ª–∞–≤, –Ø—á–∏—Å–ª–∞–≤, –û—Ä–≥–∞–∑–º–æ—Å–ª–∞–≤, –ö–∞–∫—è—Ç–µ–±–µ—Å–ª–∞–≤, –í–æ–ª–∞–Ω–¥–µ–º–æ—Ä—Ç–æ—Å–ª–∞–≤'.split(', ')
        for word in words:
            self.assertEqual(0, Antimat.bad_words_count(word), word)

    def test_oxxxymiron(self):
        words = set('–≥–æ–≤–Ω–æ –∑–∞–ª—É–ø–∞ –ø–µ–Ω–∏—Å —Ö–µ—Ä –¥–∞–≤–∞–ª–∫–∞ —Ö—É–π –±–ª—è–¥–∏–Ω–∞ –≥–æ–ª–æ–≤–∫–∞ —à–ª—é—Ö–∞ –∂–æ–ø–∞ —á–ª–µ–Ω –µ–±–ª–∞–Ω –ø–µ—Ç—É—Ö –º—É–¥–∏–ª–∞ —Ä—É–∫–æ–±–ª—É–¥ —Å—Å–∞–Ω–∏–Ω–∞ –æ—á–∫–æ –±–ª—è–¥—É–Ω –≤–∞–≥–∏–Ω–∞ —Å—É–∫–∞ –µ–±–ª–∞–Ω–∏—â–µ –≤–ª–∞–≥–∞–ª–∏—â–µ –ø–µ—Ä–¥—É–Ω –¥—Ä–æ—á–∏–ª–∞ –ø–∏–¥–æ—Ä –ø–∏–∑–¥–∞ —Ç—É–∑ –º–∞–ª–∞—Ñ—å—è –≥–æ–º–∏–∫ –º—É–¥–∏–ª–∞ –ø–∏–ª–æ—Ç–∫–∞ –º–∞–Ω–¥–∞ –∞–Ω—É—Å –≤–∞–≥–∏–Ω–∞ –ø—É—Ç–∞–Ω–∞ –ø–µ–¥—Ä–∏–ª–∞ —à–∞–ª–∞–≤–∞ —Ö—É–∏–ª–∞ –º–æ—à–æ–Ω–∫–∞ –µ–ª–¥–∞'.split(' '))
        bad = set('—Ö—É–π –±–ª—è–¥–∏–Ω–∞ –µ–±–ª–∞–Ω –±–ª—è–¥—É–Ω –µ–±–ª–∞–Ω–∏—â–µ –ø–∏–∑–¥–∞ —Ö—É–∏–ª–∞ –µ–ª–¥–∞'.split(' '))
        extended = '–º—É–¥–∏–ª–∞ –ø–∏–¥–æ—Ä –º—É–¥–∏–ª–∞ –º–∞–Ω–¥–∞ –ø–µ–¥—Ä–∏–ª–∞ –≥–æ–≤–Ω–æ –∑–∞–ª—É–ø–∞ —à–ª—é—Ö–∞ –º—É–¥–∏–ª–∞ –¥—Ä–æ—á–∏–ª–∞ —à–∞–ª–∞–≤–∞'.split(' ')
        if extended_filter_enabled:
            # TODO: –¥–æ–±–∞–≤–∏—Ç—å –≤ –ø–ª–æ—Ö–∏–µ: —Ö–µ—Ä —Å—É–∫–∞ –∂–æ–ø–∞
            bad.update(extended)
        else:
            for word in extended:
                self.assertEqual(0, Antimat.bad_words_count(word), word)
        good = words - bad
        for word in good:
            self.assertEqual(0, Antimat.bad_words_count(word), f'{word} (false positive)')
        for word in bad:
            self.assertEqual(1, Antimat.bad_words_count(word), f'{word} (should be bad)')

    def test_words(self):
        words = {
            'xy—è—Åe', '—Ö—É—è—Å–µ', 'Xy–π', '–Å–±—Ç–µ—Ç—å', '—á—Ç–æ –∑–∞ —Ö—É–π–Ω—è', '–ø—Ä–∏–µ–±–Ω—É—Ç—ã–π', '–±–ª*—è–¥—å', '–∞—Ö—É–µ–Ω–Ω–∞',
            '–µ–µ–µ–µ–µ–µ–µ–ª–¥–∞', '–ø—Ä–æ–µ–±', '—Ä–µ—Ç—Ä–æ–µ–±', '–ø–µ—à–µ–µ–±', '—Ç–æ—á–∫–æ—ë–±', '—É–¥–∫–æ–µ–±', '–∞—Ö—É–µ–ª',
            '—Ö—É–∏—Å–æ—Å–∏—Ç—å', '—Ö—É–∏—Å—Ç–∏–∫–∞', '—Ö—É–∏—Å—ã–≤–∞—Ç—å—Å—è', '—Ö—É–∏–∑–Ω—å', '—Ö—É–∏–∑–º', '–æ—Ö—É–∏—Ç–µ–ª—å–Ω—ã–π',
            '–µ–µ–µ–±–∞–∞–∞—Ç—å', '—Ö—É—é—Å–Ω–æ', '–ø–∏–∑–¥–æ—Å–∏—è', '–ø–∏–∑–¥—é–∫', '—Ö—É—é—Ö', '–±–ª—è–∫—É–∫–∞—Ä–µ–∫', '—Ö—É—é—Ç—Ä–∞', '–ø–∏–∑–¥–µ—Ü', '–µ–±–∞—Ç—å',
            '—Ö—É—é—Ç—Ä–µ—á–∫–∞', '–¥–æ–ª–±–æ—ë–±–æ–≤', '–≤—ã–±–ª—è–¥–æ–∫', '–ø–∏–∑–¥–æ—Å–∏—â–µ', '–ø–∏–∑–¥–æ—Å—Ç—Ä–∞–¥–∞–µ—Ç', '—Ö—É—é—Ç–∏–Ω–µ',
            '–¥–æ—Ö—É—è', '–Ω–∞—Ö—É–π', '—Ö—É—é—Ç–∫–∏', '–µ–±–∞–Ω—É–ª—Å—è', '–Ω–∏—Ö—É—è', '–±–ª—è–¥—å', '–±–ª—è–¥', '–±–ª—è', '–±–ª—è—á—è—è—è',
            '–ø–∏–∑–¥–æ—Å–Ω–æ', '—Ö—É—é—Å–∏', '—Ö—É–∏—Ä–∫–∞', '–ø–æ—Ö—É–∏—Ç—å', '—Ö—É–π–Ω—é', '–µ–±–µ–π—à–∏–π', '–∞—Ö—É–µ–Ω–Ω–∞', '—Ö—É—é—Å—å',
            '—Ö—É—é—Ñ', '–∑–∞–µ–±–∏—Å—å', '—Ö—É—é—Å—Å—Ç–≤–æ', '–±–ª—è–¥–æ—Ä—É–º—ã–Ω—Å–∫–∏–π', '–ø–∏–∑–¥–æ—Å–∏—â–µ–µ–µ', '–µ–±–ª–∞–Ω', '—Ö—É–∏–ª–∞',
            '—Ö—É—é—á–µ', '–ø–∏–∑–¥–∞', '—Ö—É–µ–º–æ—Ä–¥—ã–π', '–ø–∏–∑–¥–æ—Å', '–ø–∏–∑–¥–æ—Å–∏–∫–∏', '—Ö—É—é—Ç—Ä–æ', '—Ö—É—é—Ç—Ä–æ–º', '—Ö—É—é—Å–µ—á–∫–∞',
            '—Ö—É—é—Ö–µ—Ä', '—Ö—É—é—Å–µ–≤', '–±–ª—è–¥–∏–Ω–∞', '–ø–∏–∑–¥–æ—Å—Å—Å—Å—Å',
            '–ø–∏–∑–¥–æ—Å—Ç—Ä–∞–¥–∞–ª–∏—â–µ', '–Ω–∞—Ö—É—è', '–Ω–∞—Ö—É–π—å', '—Å–ø–∏–∑–¥–∏–ª–æ', '–ø–æ—Ö—É–π', '–æ—á–∫–æ—Ö—É—è–ª–∏—â–µ', '–ø–∏–∑–¥—é–∫–∞–º',
            '–æ—Ö—É–µ–Ω–Ω—ã–µ', '–±–ª—è–¥—É–Ω', '–ø–∏–∑–¥–æ—Ä–æ–¥–æ–≤', '—Ö—É—é—Ç–∞', '—Ö—É—é—Ç–æ—á–∫–∏', '–ø–∏–∑–¥–æ—Å–∏–∏–∫–∏', '–±–ª—è—Ç—å', '—Ö—É—è',
            '—Ö—É—é—Ç—Ä–µ—á–∫–æ', '—Ö—É—é—Ç', '–¥–æ–ª–±–æ–µ–±–∞–º–∏', '–±–ª—è–¥–∏–Ω–æ—Å—Ç—å', '–µ–±–ª–∞–Ω–∏—â–µ', '—Ö—É—é—Å—Å–∫–∏–π', '—Ö—É–π',
        }
        extended = {'–∑–±—Å', '—Ö–∑', '–¥–æ–¥—Ä–æ—á–∏–ª', '–¥—Ä–æ—á–∏–ª', '–¥—Ä–æ—á–∫–∞', '–¥—Ä–æ—á–∏–ª—å–Ω—è', '–∑–∞–¥—Ä–æ—á–∏–ª—Å—è', '–Ω–∞–¥—Ä–æ—á–∏–ª', '–ø–æ–¥—Ä–æ—á–∏–ª',
                    '–≥–æ–≤–Ω–æ–±–ª–æ–∂–∏–∫', '–≥—Ä–µ–±–∞–Ω—ã–π', '–≥–æ–≤–Ω–æ–±–ª–æ–≥–∏—Ä–∞', '–≥–æ–≤–Ω–æ–≤–æ–¥–∏—Ç–µ–ª–µ–π', '–º—É–¥–∞–∫', '–≥–æ–≤–Ω–æ–≤–∏–Ω–¥–æ—É—Å', '–≥–æ–≤–Ω–æ–±–∞–Ω–∫',
                    '—á–º–æ', '–≥–æ–≤–Ω–æ–∞–µ–∞–ª–∏—Ç–∏–∫', '—à–ª—é—Ö—É', '–≥–æ–≤–Ω–æ', '–≥–æ–≤–Ω–æ–±–∞—è–Ω–∞–º', '–º–∞–Ω–¥–∞', '–ø–∏–¥–æ—Ä', '–≥–æ–≤–Ω–æ–∞–≤–∞—Ç–∞—Ä–∫–∞',
                    '–≥–æ–≤–Ω–æ–∞–π–º–∞–∫—Å–∞', '–º—É–¥–∞–∫–∞', '–¥–µ—Ä—å–º–æ', '–≥–æ–Ω–¥–æ–Ω', '–∑–∞–ª—É–ø–∞', '—à–ª—é—Ö–∞', '–≥—Ä–µ–±–∞–Ω—ã–µ', '–≥—Ä—ë–±–∞–Ω–Ω—ã–µ'}
        if extended_filter_enabled:
            words.update(extended)
        else:
            for word in extended:
                self.assertEqual(0, Antimat.bad_words_count(word), f'{word} (false positive)')
        for word in words:
            self.assertEqual(1, Antimat.bad_words_count(word), word)

    def test_false_positive(self):
        words = [
            '—Å–µ–±—è', '—Å–µ–±–µ', '–Ω–µ –±—É–¥–µ—Ç', 'sasha_rebinder', 'rebinder', '–Ω–∏–∂–µ –±—ã–ª–∏', '—Ä–µ–±–∏–Ω–¥–µ—Ä',
            '—Ä–µ–±—è—Ç–∞', '—Ä–µ–±–∑—è', '–º–µ–±–µ–ª—å', '–º–µ–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ', '—Ä–µ–±—è—Ç–∏—à–∫–∏', '—á–µ–±—É—Ä–∞—à–∫–∞', '–∫–æ–º–∞–Ω–¥—É',
            '–∫–æ–º–∞–Ω–¥–∞', '–∫–æ–º–∞–Ω–¥—ã', '–≤–µ–±', 'web', '–≤—ç–±–¥–∏–∑–∞–π–Ω', '–≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü–∞', '–Ω–µ–±–æ—Å—å', '—Ç–µ–±—è',
            '42—Ä—É–±–ª—è', 'ebay', 'ebook', 'eboot', 'snegopad', '—á–µ–±—É—Ä–Ω–µ—Ç', '—á–µ–±—É—Ä–∞—Ç–æ—Ä', '—Å–Ω–µ–≥–æ–ø–∞–¥',
            '–∞–∑–∏–º–∞–Ω–¥–∏–π', '–∞–º–∞–Ω–¥–∞', '–∞–º–∞–Ω–¥—ã', '–±–µ–∑–º–∞–Ω–¥–∞—Ä–∏–Ω–æ–≤—ã–π', '–±–µ—Å—Ö—Ä–µ–±–µ—Ç–Ω—ã–π', '–±–µ–ª—å–º–æ–Ω–¥–æ',
            '–±–æ–º–æ–Ω–¥', '–±—É—Ö—É—é', '–≤–∑–∞—Ö–ª–µ–±', '–≤–∑–∞—Ö–ª—ë–±', '–≤–æ–µ–Ω–Ω–æ–∫–æ–º–∞–Ω–¥—É—é—â–∏–º–∏', '–≤–æ–ª—à–µ–±–Ω—É—é', '–≤–æ–ª—à–µ–±–Ω–∞—è',
            '–≤–æ–ª—à–µ–±–Ω–∏–∫', '–≤–æ–ª—à–µ–±—Å—Ç–≤–æ', '–≤—Ç–∏—Ö—É—é', '—Ö—É–∏—Å', '—Ö—É–∏–∑', '–≤—ã–≥—Ä–µ–±–Ω—É—é', '–≥–ª–∞–≤–Ω–æ–∫–æ–º–∞–Ω–¥—É—é—â–µ–º—É',
            '–≥–ª–∞–≤–Ω–æ–∫–æ–º–∞–Ω–¥—É—é—â–∏–π', '–¥–∞–±–ª–∫–æ–º–∞–Ω–¥–µ—Ä', '–¥–∞–±–ª–∫–æ–º–º–∞–Ω–¥–µ—Ä', '—Ç–æ—Ç–∞–ª–∫–æ–º–∞–Ω–¥–µ—Ä', '–∫–æ–º–∞–Ω–¥–µ—Ä', '–∫–æ–º–∞–Ω–¥–∏—Ä',
            '–¥–µ–±–∞—Ç–∞–º', '–¥–µ–±–∞—Ç–∞—Ö', '–¥–µ–±–∞—Ç–∏—Ä–æ–≤–∞–ª–∞', '–¥–µ–±–∞—Ç–æ–≤', '–¥–µ–±–∞—Ç—ã', '–¥–µ–±–µ—Ç–∫–∞', '–¥–µ–±–µ—Ç–æ–≤–∞—è', '–µ–±–∏–ª–¥–æ–≤',
            '–µ–±–∏–ª–¥', '–µ—â–µ–±', '–µ—â—ë–±', '–∑–∞–≥—Ä–µ–±', '–∑–∞–≥—Ä–µ–±–µ', '–∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª—è—Ç—å', '–∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ',
            '–∫–æ–º–º–∞–Ω–¥–µ—Ä', '–∫–æ–º–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∏', '–∫–æ–º–º–∞–Ω–¥–Ω–∏–∫–∞', '–∫–æ–º–º–∞–Ω–¥–æ—Å', '–∫–æ–º–º–∞–Ω–¥—ã', '–∫–æ—Ä–∞–±–ª—è', '–∫—Ä–∞—Å–Ω–æ—É—Ö—É—é',
            '–∫—Ä–∞—Å–Ω–æ—É—Ö–∏–µ', '–ª–µ—á–µ–±–Ω—É—é', '–ª–µ—á–µ–±–Ω–∞—è', '–º–∞–Ω–¥–∞—Ç', '–º–∞–Ω–¥—Ä–∞–∂', '–Ω–∞—Å–∫—Ä–µ–±—Å—Ç–∏', '–Ω–∞—Å–∫—Ä–µ–±—ë—Ç', '–Ω–∞—Å—É—Ö—É—é',
            '–Ω–µ–±–æ—Å–∫—Ä–µ–±', '–Ω–æ—Ä–º–∞–Ω–¥–∏–∏', '–æ–±–æ—Å–æ–±–ª—è–ª–∞', '–æ–∑–∏–º–∞–Ω–¥–∏–π', '–æ—Å–ª–∞–±–ª—è–µ—Ç', '–ø–µ—Ä–µ–±–∞–Ω–∏—Ç—å', '–ø–æ–≥—Ä–µ–±',
            '–ø–ª–æ—Ö—É—é', '–ø–æ–¥—Å—Ç–µ–±–∞—Ç—å', '–ø–æ–¥—Å—Ç–µ–±', '–ø–æ–¥—Å—Ç–µ–±–Ω—É–ª–∞', '–ø–æ–∫–æ–º–∞–Ω–¥–æ–≤–∞—Ç—å', '–ø–æ–æ—Å–∫–æ—Ä–±–ª—è—Ç—å', '–æ—Å–∫–æ—Ä–±–ª—è—Ç—å',
            '–ø–æ—Å–∫—Ä—ë–±', '–ø–æ—Å–ª–∞–±–ª—è—é—â–µ–µ', '–ø–æ—Å—Ç–µ–±–∞—Ç—å', '–ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç', '–ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç–µ', '–ø–æ—Ç—Ä–µ–±–ª—è–µ—à—å', '–ø–æ—Ç—Ä–µ–±–ª—è–ª–∞',
            '–ø–æ—Ç—Ä–µ–±–ª—è—é—Ç', '–ø–æ—Ç—Ä–µ–±—É–µ—Ç', '–ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è', '–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ', '–ø–æ—Ç—Ä–µ–±—Å—Ç–≤–æ', '–ø—Ä–∏–≥—É–±–ª—è—Ç—å',
            '–ø—Ä–æ—Ç–æ–∞—Ä—Ö–∏–º–∞–Ω–¥—Ä–∏—Ç–æ–º', '–ø—Å–∏—Ö—É–µ—Ç', '–ø—Å–∏—Ö—É—é', '–ø—Å–∏—Ö—É—é—â–∏–π', '—Ä–∞–∑–≥—Ä–µ–±–∞—Ç—å', '—Ä–∞–∑–≥—Ä–µ–±–∞–ª–∞',
            '—Ä–∞—Å—Å–ª–∞–±–ª—è–µ–º—Å—è', '—Ä–∞—Å—Å–ª–∞–±–ª—è–µ—Ç', '—Ä–∞—Å—Å–ª–∞–±–ª—è—é—â–∏–µ', '—Ä–µ–±—É—Ç', '—Ä–µ–±—É—Ç–Ω—É—Ç—å', '—Ä–µ–±—É—Å', '—Ä–æ—Å–ø–æ—Ç—Ä–µ–±',
            '—Ä—É–±–ª—è–º', '—Ä—É–±–ª—è—Ö', '—Å–∞–±–ª—è–º–∏', '—Å–∞–±–ª—è', '—Å–∞–ª–∞–º–∞–Ω–¥—Ä', '—Å–∞–ª–∞–º–∞–Ω–¥—Ä–∞', '—Å–≤–∞–¥–µ–±', '—Å–≤–∞–¥–µ–±–Ω—É—é',
            '—Å–≥—Ä—ë–±', '—Å–∫—Ä–µ–±–µ—Ç', '—Å–∫—Ä–µ–±—É—Ç—Å—è', '—Å–ø–∏–¥–æ—Ä–∞–∫', '—Å–ø–∏–¥–æ—Ä–∞–∫–æ–≤–æ–µ', '—Å–ø–∏–¥—Ä–∞–Ω–∏–ª', '—Å–ø–∏–¥—Ä–∞–Ω–Ω–µ—Ä—ã',
            '—Å—Ç–µ–±', '—Å—Ç–µ–±–∞–ª', '—Å—Ç–µ–±–∞–ª–∞—Å—å', '—Å—Ç–µ–±–∞–ª–∏', '—Å—Ç–µ–±–∞–ª–∏—Å—å', '—Å—Ç–µ–±–∞–ª—Å—è', '—Å—Ç–µ–±–∞–Ω—É–ª—Å—è', '—Å—Ç–µ–±–∞—Ç—å',
            '—Å—Ç–µ–±–µ—Ç–µ—Å—å', '—Å—Ç–µ–±–µ—Ç—Å—è', '—Å—Ç–µ–±—É—Ç', '—Å—Ç—ë–±', '—Å—É–¥–µ–±–Ω—É—é', '—Å—É–¥–µ–±–Ω–∞—è', '—Ç–∞–ª–µ–±', '—Ç–µ–±–µ-—Ç–æ', '—Å–µ–±—è-—Ç–æ',
            '—Ç—Ä–µ–±—É–µ—Ç', '—Ç—Ä–µ–±—É–µ—Ç—Å—è', '—Ç—Ä—É–¥–æ–≤—ã–µ–±—É–¥–Ω–∏', '—É–≥–ª—É–±–ª—è—Ç—å—Å—è', '—É–ø–æ–¥–æ–±–ª—è–µ—à—å—Å—è', '—É–ø–æ–¥–æ–±–ª—è—Ç—å—Å—è',
            '—É–ø–æ—Ç—Ä–µ–±–ª—è–µ—à—å', '—É–ø–æ—Ç—Ä–µ–±–ª—è—Ç—å', '—É—Å—É–≥—É–±–ª—è–µ—Ç', '—É—Å—É–≥—É–±–ª—è–π', '–Ω–µ—É—Å—É–≥—É–±–ª—è–π', '—É—Ö—É', '—É—á–µ–±—É',
            '—É—á–µ–±—É/—Ç—É—Ä–∏–∑–º', '—Ö–∞–º–º–æ–Ω–¥', '—Ö–ª–µ–±', '—Ö–ª–µ–±–∞–ª–∏', '—Ö–ª–µ–±–Ω—É—Ç—å', '—Ö—Ä–µ–±–µ—Ç', '—á–∞—Ä–º–æ–Ω–¥–µ—Ä', '—à–∏—Ä–ø–æ—Ç—Ä–µ–±',
            '–±–ª—è—Ö–∞', '–±–ª—è—Ö–∞–º—É—Ö–∞', '–±–ª—è—Ö–∞-–º—É—Ö–∞', '–µ–±—É–∫', '–¥–µ–±–µ—Ç', '–≤–µ–ª–ª–¥–∞–Ω', '–Ω–µ–±–∞—Ç–∞–ª–æ–≤', '–Ω–µ–±–æ—Å–∫–ª–æ–Ω',
            '–ø–µ–¥—Ä–æ', '–¥—É–±–ª—è–∂', '–¥—É–±–ª—è–∂–∞–º', '—Ö—É–∏–∑–∏—Ç', '—Ö—É–∏—Å–∏—Ç', '—â–µ–±–µ—Ç', '—â–µ–±–µ—Ç–∞–ª–∏', '–ø–æ–≥—Ä–µ–±–∞–ª—å–Ω–∞—è',
            '—á–º–æ–∫–Ω—É–ª', '—á–º–æ–∫–∞–ª', '—Ç–∏—Ö—É—é', '–∏—Å—Ç—Ä–µ–±–∏—Ç—Å—è', '–ª–∏—Ö—É—é', '–æ–≥–ª–æ–±–ª—è—Ö', '—Ä–∞–∑–¥—Ä–æ–±–ª—è—é—Ç—Å—è', '–ø–æ–≥—Ä–µ–±–µ–Ω–∏—è',
            '–≥—Ä–µ–±—Å—Ç–∏', '–∏–∫–µ–±–∞–Ω–∞', '—Å–ª—ã—à–∞–ª–∞/–≤–∏–¥–µ–ª–∞', '–≥—Ä–∞–±–ª—è–º–∏', '–∑–∞–≥—Ä–µ–±–∞–ª–∏', '–≥—Ä–µ–±–µ—Ç', '–≥—Ä–µ–±–Ω–∞—è', '–±–ª—è—à–µ–∫',
            '–æ—Å–∫–ª—è–±–ª—è—è—Å—å', 'BASOULHQUNXYYNXCWREHVFHRO2A', '—Ö—É—É', 'XYYN',
        ]
        for word in words:
            self.assertEqual(0, Antimat.bad_words_count(word), word)
